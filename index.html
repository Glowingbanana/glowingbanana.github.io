<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PDF to Excel Converter</title>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

  <style>
    * { margin:0; padding:0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      min-height: 100vh; display:flex; align-items:center; justify-content:center;
      padding:1rem; color:#333;
    }
    .container {
      background:#fff; border-radius:12px; box-shadow:0 10px 40px rgba(0,0,0,.2);
      width:100%; max-width:820px; padding:2rem;
    }
    h1 { text-align:center; margin-bottom:.5rem; }
    .subtitle{ text-align:center; color:#666; margin-bottom:1.25rem; }
    .upload-area{ border:2px dashed #667eea; border-radius:8px; padding:2rem; text-align:center; cursor:pointer; background:#f9f9f9; margin-bottom:1rem; }
    .upload-area:hover{ background:#f0f0f0; border-color:#764ba2; }
    .upload-area.dragover{ background:#e8e4f3; border-color:#764ba2; }
    .upload-area input{ display:none; }
    .options{ display:grid; grid-template-columns:1fr 1fr; gap:.75rem; margin:.75rem 0 1.25rem 0; align-items:center; }
    .option-item{ display:flex; gap:.5rem; align-items:center; font-size:.9rem; color:#444; }
    .file-info{ background:#f7f7f7; padding:.75rem 1rem; border-radius:8px; margin-bottom:.75rem; display:none; }
    .file-info.show{ display:block; }
    .status{ padding:.75rem 1rem; border-radius:8px; margin:.75rem 0; display:none; text-align:center; }
    .status.show{ display:block; } .status.success{ background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
    .status.error{ background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
    .status.loading{ background:#d1ecf1; color:#0c5460; border:1px solid #bee5eb; }
    .preview{ background:#fafafa; padding:1rem; border-radius:8px; margin-bottom:1rem; max-height:260px; overflow-y:auto; border:1px solid #eaeaea; display:none; white-space:pre-wrap; }
    .preview.show{ display:block; }
    .button-group{ display:grid; grid-template-columns:1fr 1fr; gap:.75rem; margin-top:.5rem; }
    button{ padding:.75rem 1rem; border:none; border-radius:6px; cursor:pointer; font-weight:600; font-size:.95rem; transition:all .2s; }
    button:disabled{ opacity:.6; cursor:not-allowed; }
    .btn-convert{ background:#28a745; color:#fff; grid-column:1 / -1; }
    .btn-clear{ background:#999; color:#fff; }
    .btn-download{ background:#667eea; color:#fff; display:none; }
    .paste-wrap{ margin:1rem 0 .5rem 0; }
    .paste-wrap label{ display:block; font-weight:600; margin-bottom:.35rem; }
    .paste-wrap textarea{ width:100%; height:120px; padding:.75rem; border:1px solid #ddd; border-radius:8px; font-family:ui-monospace, Menlo, Consolas, monospace; font-size:.9rem; resize:vertical; }
    .spinner{ display:inline-block; width:16px; height:16px; border:2px solid rgba(0,0,0,.15); border-top-color:rgba(0,0,0,.6); border-radius:50%; animation:spin .8s linear infinite; margin-right:8px; vertical-align:-2px; }
    @keyframes spin{ to{ transform:rotate(360deg); } }
    .small-hint{ color:#777; font-size:.85rem; margin-top:.25rem; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìÑ ‚û°Ô∏è üìä PDF to Excel</h1>
    <p class="subtitle">One wide sheet ‚Äî one row per line item (headers match your sample).</p>

    <div class="upload-area" id="uploadArea">
      <div style="font-size:2rem; margin-bottom:.5rem;">üìÅ</div>
      <div style="font-weight:600;">Click to upload or drag & drop</div>
      <div style="color:#777; margin-top:.25rem;">PDF files only</div>
      <input type="file" id="fileInput" accept=".pdf,application/pdf" />
    </div>

    <div class="options">
      <label class="option-item"><input type="checkbox" id="forceOCR" /> <span>Force OCR</span></label>
      <label class="option-item"><input type="checkbox" id="excludeDraft" /> <span>Exclude Draft invoices</span></label>
    </div>

    <div class="file-info" id="fileInfo">
      <div id="fileName"></div>
      <div id="fileSize" class="small-hint"></div>
    </div>

    <div class="paste-wrap">
      <label for="textInput">Or paste text to convert directly:</label>
      <textarea id="textInput" placeholder="Paste text here if you don't have a PDF..."></textarea>
      <div class="small-hint">If no PDF is selected, clicking "Convert to Excel" will convert the pasted text.</div>
    </div>

    <div class="status" id="status"></div>

    <div class="preview" id="preview">
      <div style="font-weight:700; margin-bottom:.5rem;">Preview (first 800 characters):</div>
      <div id="previewContent"></div>
    </div>

    <div class="button-group">
      <button class="btn-clear" id="btnClear" onclick="clearFile()">Clear</button>
      <button class="btn-convert" id="btnConvert" onclick="convertPDF()" disabled>Convert to Excel</button>
      <button class="btn-download" id="btnDownload" onclick="downloadExcel()">Download Excel File</button>
    </div>
  </div>

  <script>console.info('Build: OptionA-headers-from-sample v1.2');</script>
  <script src="script.js?v=1.2"></script>
</body>
</html>
